Starting at: 
2022-11-10 18:32:15

 Random seed:  1  



############# Defined asset basket #################
timeseries_basket.keys() = 
dict_keys(['basket_type', 'basket_id', 'basket_desc', 'basket_label', 'basket_columns', 'basket_timeseries_names'])
timeseries_basket['basket_type'] = asset
timeseries_basket['basket_id'] = basic_T30_VWD
timeseries_basket['basket_desc'] = CRSP data: T30 and VWD
timeseries_basket['basket_columns'] = 
['T30_real_ret', 'VWD_real_ret']
############# End: defined asset  basket #################
-----------------------------------------------
No need to read market data.
-----------------------------------------------
5.0% of MC simulations done.
10.0% of MC simulations done.
15.0% of MC simulations done.
20.0% of MC simulations done.
25.0% of MC simulations done.
30.0% of MC simulations done.
35.0% of MC simulations done.
40.0% of MC simulations done.
45.0% of MC simulations done.
50.0% of MC simulations done.
55.00000000000001% of MC simulations done.
60.0% of MC simulations done.
65.0% of MC simulations done.
70.0% of MC simulations done.
75.0% of MC simulations done.
80.0% of MC simulations done.
85.0% of MC simulations done.
90.0% of MC simulations done.
95.0% of MC simulations done.
100.0% of MC simulations done.
--------------------------------------------------------------------------------------------------
Neural_Network object 'obj' has instance attribute obj.layers.
obj.layers is a list of 'Neural_Network_Layer' objects with following attributes:

/home/marcchen/Documents/pytorch_1/researchcode/class_Neural_Network.py:344: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  layers_info_df = layers_info_df.append(layer_dict, ignore_index=True)
/home/marcchen/Documents/pytorch_1/researchcode/class_Neural_Network.py:344: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  layers_info_df = layers_info_df.append(layer_dict, ignore_index=True)
/home/marcchen/Documents/pytorch_1/researchcode/class_Neural_Network.py:344: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  layers_info_df = layers_info_df.append(layer_dict, ignore_index=True)
/home/marcchen/Documents/pytorch_1/researchcode/class_Neural_Network.py:344: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  layers_info_df = layers_info_df.append(layer_dict, ignore_index=True)
  obj.layers[layer_id] layer_id   description n_nodes activation x_l(weights)  \
0        obj.layers[0]        0   input_layer       2       None         None   
1        obj.layers[1]        1  hidden_layer    None       None         None   
2        obj.layers[2]        2  hidden_layer    None       None         None   
3        obj.layers[3]        3  output_layer       2       None         None   

  add_bias b_l(biases)  
0    False        None  
1    False        None  
2    False        None  
3    False        None  

 Run 'update_layer' method of Neural_Network object to change layer attributes.
--------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------
Neural_Network object 'obj' has instance attribute obj.layers.
obj.layers is a list of 'Neural_Network_Layer' objects with following attributes:

/home/marcchen/Documents/pytorch_1/researchcode/class_Neural_Network.py:344: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  layers_info_df = layers_info_df.append(layer_dict, ignore_index=True)
/home/marcchen/Documents/pytorch_1/researchcode/class_Neural_Network.py:344: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  layers_info_df = layers_info_df.append(layer_dict, ignore_index=True)
/home/marcchen/Documents/pytorch_1/researchcode/class_Neural_Network.py:344: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  layers_info_df = layers_info_df.append(layer_dict, ignore_index=True)
/home/marcchen/Documents/pytorch_1/researchcode/class_Neural_Network.py:344: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  layers_info_df = layers_info_df.append(layer_dict, ignore_index=True)
  obj.layers[layer_id] layer_id   description n_nodes        activation  \
0        obj.layers[0]        0   input_layer       2              None   
1        obj.layers[1]        1  hidden_layer       4  logistic_sigmoid   
2        obj.layers[2]        2  hidden_layer       4  logistic_sigmoid   
3        obj.layers[3]        3  output_layer       2           softmax   

  x_l(weights) add_bias b_l(biases)  
0         None    False        None  
1       (2, 4)    False        None  
2       (4, 4)    False        None  
3       (4, 2)    False        None  

 Run 'update_layer' method of Neural_Network object to change layer attributes.
--------------------------------------------------------------------------------------------------
  obj.layers[layer_id]  layer_id   description  n_nodes        activation  \
0        obj.layers[0]         0   input_layer        2              None   
0        obj.layers[1]         1  hidden_layer        4  logistic_sigmoid   
0        obj.layers[2]         2  hidden_layer        4  logistic_sigmoid   
0        obj.layers[3]         3  output_layer        2           softmax   

  x_l(weights)  add_bias b_l(biases)  
0         None     False        None  
0       (2, 4)     False        None  
0       (4, 4)     False        None  
0       (4, 2)     False        None  
Pytorch NN pbject created from original NN class. Change            original NN object to change structure.
-----------------------------------------------
Selected results: ConstProp_strategy on TRAINING dataset
W_T_mean: 1261.0877712339752
W_T_median: 1222.733226526609
W_T_pctile_5: 834.028380700438
W_T_CVAR_5_pct: 747.2411321494716
-----------------------------------------------
2.0% of gradient descent iterations done. Method = A
objective value function right now is: -2105.0471913307965
4.0% of gradient descent iterations done. Method = A
objective value function right now is: -2115.201826606785
6.0% of gradient descent iterations done. Method = A
objective value function right now is: -2121.7291275710986
8.0% of gradient descent iterations done. Method = A
objective value function right now is: -2126.151209931867
10.0% of gradient descent iterations done. Method = A
objective value function right now is: -2127.39159354631
12.0% of gradient descent iterations done. Method = A
objective value function right now is: -2127.0504456481153
14.000000000000002% of gradient descent iterations done. Method = A
objective value function right now is: -2128.643653667223
16.0% of gradient descent iterations done. Method = A
objective value function right now is: -2127.417425974656
18.0% of gradient descent iterations done. Method = A
objective value function right now is: -2127.588672220373
20.0% of gradient descent iterations done. Method = A
objective value function right now is: -2131.150050533534
22.0% of gradient descent iterations done. Method = A
objective value function right now is: -2129.5077152310982
24.0% of gradient descent iterations done. Method = A
objective value function right now is: -2128.96400184768
26.0% of gradient descent iterations done. Method = A
objective value function right now is: -2128.33241264804
28.000000000000004% of gradient descent iterations done. Method = A
objective value function right now is: -2124.701184295374
30.0% of gradient descent iterations done. Method = A
objective value function right now is: -2127.0959197902703
32.0% of gradient descent iterations done. Method = A
objective value function right now is: -2129.0040112473384
34.0% of gradient descent iterations done. Method = A
objective value function right now is: -2124.6923027502353
36.0% of gradient descent iterations done. Method = A
objective value function right now is: -2131.360524152131
38.0% of gradient descent iterations done. Method = A
objective value function right now is: -2124.7027046977096
40.0% of gradient descent iterations done. Method = A
objective value function right now is: -2130.7017541876344
42.0% of gradient descent iterations done. Method = A
objective value function right now is: -2131.420052775118
44.0% of gradient descent iterations done. Method = A
objective value function right now is: -2130.3351293606647
46.0% of gradient descent iterations done. Method = A
objective value function right now is: -2129.065816188194
48.0% of gradient descent iterations done. Method = A
objective value function right now is: -2127.96663911061
50.0% of gradient descent iterations done. Method = A
objective value function right now is: -2129.6368323541246
52.0% of gradient descent iterations done. Method = A
objective value function right now is: -2130.0890075244947
54.0% of gradient descent iterations done. Method = A
objective value function right now is: -2128.439039532317
56.00000000000001% of gradient descent iterations done. Method = A
objective value function right now is: -2130.298240327932
57.99999999999999% of gradient descent iterations done. Method = A
objective value function right now is: -2129.9449327106163
60.0% of gradient descent iterations done. Method = A
objective value function right now is: -2130.997113792419
62.0% of gradient descent iterations done. Method = A
objective value function right now is: -2119.8298468285057
64.0% of gradient descent iterations done. Method = A
objective value function right now is: -2131.0368354850652
66.0% of gradient descent iterations done. Method = A
objective value function right now is: -2129.5341205630766
68.0% of gradient descent iterations done. Method = A
objective value function right now is: -2130.3186672907773
70.0% of gradient descent iterations done. Method = A
objective value function right now is: -2129.8054847169683
72.0% of gradient descent iterations done. Method = A
objective value function right now is: -2130.427328784875
74.0% of gradient descent iterations done. Method = A
objective value function right now is: -2128.87015455398
76.0% of gradient descent iterations done. Method = A
objective value function right now is: -2130.45753785158
78.0% of gradient descent iterations done. Method = A
objective value function right now is: -2130.4828006622524
80.0% of gradient descent iterations done. Method = A
objective value function right now is: -2130.138169515054
82.0% of gradient descent iterations done. Method = A
objective value function right now is: -2128.2559504296537
84.0% of gradient descent iterations done. Method = A
objective value function right now is: -2129.8777887135157
86.0% of gradient descent iterations done. Method = A
objective value function right now is: -2130.8604622199773
88.0% of gradient descent iterations done. Method = A
objective value function right now is: -2131.905167842984
90.0% of gradient descent iterations done. Method = A
objective value function right now is: -2126.471642979781
92.0% of gradient descent iterations done. Method = A
objective value function right now is: -2129.222740506269
94.0% of gradient descent iterations done. Method = A
objective value function right now is: -2125.7434990349293
96.0% of gradient descent iterations done. Method = A
objective value function right now is: -2131.679692786781
98.0% of gradient descent iterations done. Method = A
objective value function right now is: -2130.6547207934186
100.0% of gradient descent iterations done. Method = A
objective value function right now is: -2132.079133894249
NN weights: [-1.04582489e+00  1.57937157e+00 -5.15621758e+00 -5.17148447e+00
  1.05449092e+00 -1.78205848e+00  6.37931108e+00  5.82148170e+00
 -5.69094229e+00 -3.25781298e+00  8.75040531e+00  3.20219588e+00
  7.15894127e+00 -1.07076287e+00 -7.94061327e+00 -6.21575470e+01
 -6.37928772e+00  1.04119005e+01 -8.85655594e+00 -1.42173691e+02
 -1.09032316e+01 -1.45240622e+01  3.85819888e+00  3.40142155e+00
  3.20651221e+00 -3.69407368e+00  1.19582288e-01 -2.36513352e+00
  4.12058878e+00  1.02540195e+00 -1.25731039e+00  2.28760529e+00]
Minimum obj value:-2132.7464847119068
Optimal xi: 27.942894
/home/marcchen/Documents/pytorch_1/researchcode/fun_train_NN.py:236: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  res_ALL_dataframe = res_ALL_dataframe.append(res_ALL[key]["summary_df"], ignore_index=True)
/home/marcchen/Documents/pytorch_1/researchcode/fun_train_NN.py:248: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  res_ALL_dataframe = res_ALL_dataframe.append(res_BEST_temp["summary_df"], ignore_index=True)
-----------------------------------------------
Selected results: NN-strategy-on-TRAINING dataset
W_T_mean: 1441.6797000066151
W_T_median: 1215.9659765163346
W_T_pctile_5: 784.2549896076803
W_T_CVAR_5_pct: 691.2228851269657
F value: -2132.7464847119068
-----------------------------------------------
/home/marcchen/Documents/pytorch_1/researchcode/fun_Plot_NN_control_DataHeatmaps.py:157: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  plt.savefig(fig_filename, format=save_Figures_format, bbox_inches="tight")
-----------------------------------------------
Just FINISHED: 
Asset basket ID: basic_T30_VWD
Objective function: mean_cvar_single_level
Tracing param: 1.0
F value: -2132.7464847119068
-----------------------------------------------
