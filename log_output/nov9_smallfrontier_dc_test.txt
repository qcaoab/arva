Starting at: 
2022-11-09 10:07:18


############# Defined asset basket #################
timeseries_basket.keys() = 
dict_keys(['basket_type', 'basket_id', 'basket_desc', 'basket_label', 'basket_columns', 'basket_timeseries_names'])
timeseries_basket['basket_type'] = asset
timeseries_basket['basket_id'] = B10_and_VWD
timeseries_basket['basket_desc'] = CRSP data: B10 and VWD
timeseries_basket['basket_columns'] = 
['B10_real_ret', 'VWD_real_ret']
############# End: defined asset  basket #################
-----------------------------------------------
No need to read market data.
-----------------------------------------------
3.3333333333333335% of MC simulations done.
6.666666666666667% of MC simulations done.
10.0% of MC simulations done.
13.333333333333334% of MC simulations done.
16.666666666666664% of MC simulations done.
20.0% of MC simulations done.
23.333333333333332% of MC simulations done.
26.666666666666668% of MC simulations done.
30.0% of MC simulations done.
33.33333333333333% of MC simulations done.
36.666666666666664% of MC simulations done.
40.0% of MC simulations done.
43.333333333333336% of MC simulations done.
46.666666666666664% of MC simulations done.
50.0% of MC simulations done.
53.333333333333336% of MC simulations done.
56.666666666666664% of MC simulations done.
60.0% of MC simulations done.
63.33333333333333% of MC simulations done.
66.66666666666666% of MC simulations done.
70.0% of MC simulations done.
73.33333333333333% of MC simulations done.
76.66666666666667% of MC simulations done.
80.0% of MC simulations done.
83.33333333333334% of MC simulations done.
86.66666666666667% of MC simulations done.
90.0% of MC simulations done.
93.33333333333333% of MC simulations done.
96.66666666666667% of MC simulations done.
100.0% of MC simulations done.
Withdrawal NN:
--------------------------------------------------------------------------------------------------
Neural_Network object 'obj' has instance attribute obj.layers.
obj.layers is a list of 'Neural_Network_Layer' objects with following attributes:

/home/marcchen/Documents/pytorch_decumulation_mc/researchcode/class_Neural_Network.py:344: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  layers_info_df = layers_info_df.append(layer_dict, ignore_index=True)
/home/marcchen/Documents/pytorch_decumulation_mc/researchcode/class_Neural_Network.py:344: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  layers_info_df = layers_info_df.append(layer_dict, ignore_index=True)
/home/marcchen/Documents/pytorch_decumulation_mc/researchcode/class_Neural_Network.py:344: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  layers_info_df = layers_info_df.append(layer_dict, ignore_index=True)
/home/marcchen/Documents/pytorch_decumulation_mc/researchcode/class_Neural_Network.py:344: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  layers_info_df = layers_info_df.append(layer_dict, ignore_index=True)
  obj.layers[layer_id] layer_id   description n_nodes activation x_l(weights)  \
0        obj.layers[0]        0   input_layer       2       None         None   
1        obj.layers[1]        1  hidden_layer    None       None         None   
2        obj.layers[2]        2  hidden_layer    None       None         None   
3        obj.layers[3]        3  output_layer       1       None         None   

  add_bias b_l(biases)  
0    False        None  
1    False        None  
2    False        None  
3    False        None  

 Run 'update_layer' method of Neural_Network object to change layer attributes.
--------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------
Neural_Network object 'obj' has instance attribute obj.layers.
obj.layers is a list of 'Neural_Network_Layer' objects with following attributes:

/home/marcchen/Documents/pytorch_decumulation_mc/researchcode/class_Neural_Network.py:344: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  layers_info_df = layers_info_df.append(layer_dict, ignore_index=True)
/home/marcchen/Documents/pytorch_decumulation_mc/researchcode/class_Neural_Network.py:344: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  layers_info_df = layers_info_df.append(layer_dict, ignore_index=True)
/home/marcchen/Documents/pytorch_decumulation_mc/researchcode/class_Neural_Network.py:344: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  layers_info_df = layers_info_df.append(layer_dict, ignore_index=True)
/home/marcchen/Documents/pytorch_decumulation_mc/researchcode/class_Neural_Network.py:344: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  layers_info_df = layers_info_df.append(layer_dict, ignore_index=True)
  obj.layers[layer_id] layer_id   description n_nodes        activation  \
0        obj.layers[0]        0   input_layer       2              None   
1        obj.layers[1]        1  hidden_layer       4  logistic_sigmoid   
2        obj.layers[2]        2  hidden_layer       4  logistic_sigmoid   
3        obj.layers[3]        3  output_layer       1  logistic_sigmoid   

  x_l(weights) add_bias b_l(biases)  
0         None    False        None  
1       (2, 4)    False        None  
2       (4, 4)    False        None  
3       (4, 1)    False        None  

 Run 'update_layer' method of Neural_Network object to change layer attributes.
--------------------------------------------------------------------------------------------------
Allocation NN:
--------------------------------------------------------------------------------------------------
Neural_Network object 'obj' has instance attribute obj.layers.
obj.layers is a list of 'Neural_Network_Layer' objects with following attributes:

/home/marcchen/Documents/pytorch_decumulation_mc/researchcode/class_Neural_Network.py:344: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  layers_info_df = layers_info_df.append(layer_dict, ignore_index=True)
/home/marcchen/Documents/pytorch_decumulation_mc/researchcode/class_Neural_Network.py:344: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  layers_info_df = layers_info_df.append(layer_dict, ignore_index=True)
/home/marcchen/Documents/pytorch_decumulation_mc/researchcode/class_Neural_Network.py:344: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  layers_info_df = layers_info_df.append(layer_dict, ignore_index=True)
/home/marcchen/Documents/pytorch_decumulation_mc/researchcode/class_Neural_Network.py:344: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  layers_info_df = layers_info_df.append(layer_dict, ignore_index=True)
  obj.layers[layer_id] layer_id   description n_nodes activation x_l(weights)  \
0        obj.layers[0]        0   input_layer       2       None         None   
1        obj.layers[1]        1  hidden_layer    None       None         None   
2        obj.layers[2]        2  hidden_layer    None       None         None   
3        obj.layers[3]        3  output_layer       2       None         None   

  add_bias b_l(biases)  
0    False        None  
1    False        None  
2    False        None  
3    False        None  

 Run 'update_layer' method of Neural_Network object to change layer attributes.
--------------------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------------------
Neural_Network object 'obj' has instance attribute obj.layers.
obj.layers is a list of 'Neural_Network_Layer' objects with following attributes:

/home/marcchen/Documents/pytorch_decumulation_mc/researchcode/class_Neural_Network.py:344: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  layers_info_df = layers_info_df.append(layer_dict, ignore_index=True)
/home/marcchen/Documents/pytorch_decumulation_mc/researchcode/class_Neural_Network.py:344: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  layers_info_df = layers_info_df.append(layer_dict, ignore_index=True)
/home/marcchen/Documents/pytorch_decumulation_mc/researchcode/class_Neural_Network.py:344: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  layers_info_df = layers_info_df.append(layer_dict, ignore_index=True)
/home/marcchen/Documents/pytorch_decumulation_mc/researchcode/class_Neural_Network.py:344: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  layers_info_df = layers_info_df.append(layer_dict, ignore_index=True)
  obj.layers[layer_id] layer_id   description n_nodes        activation  \
0        obj.layers[0]        0   input_layer       2              None   
1        obj.layers[1]        1  hidden_layer       4  logistic_sigmoid   
2        obj.layers[2]        2  hidden_layer       4  logistic_sigmoid   
3        obj.layers[3]        3  output_layer       2           softmax   

  x_l(weights) add_bias b_l(biases)  
0         None    False        None  
1       (2, 4)    False        None  
2       (4, 4)    False        None  
3       (4, 2)    False        None  

 Run 'update_layer' method of Neural_Network object to change layer attributes.
--------------------------------------------------------------------------------------------------
  obj.layers[layer_id]  layer_id   description  n_nodes        activation  \
0        obj.layers[0]         0   input_layer        2              None   
0        obj.layers[1]         1  hidden_layer        4  logistic_sigmoid   
0        obj.layers[2]         2  hidden_layer        4  logistic_sigmoid   
0        obj.layers[3]         3  output_layer        1  logistic_sigmoid   

  x_l(weights)  add_bias b_l(biases)  
0         None     False        None  
0       (2, 4)     False        None  
0       (4, 4)     False        None  
0       (4, 1)     False        None  
Pytorch NN pbject created from original NN class. Change            original NN object to change structure.
  obj.layers[layer_id]  layer_id   description  n_nodes        activation  \
0        obj.layers[0]         0   input_layer        2              None   
0        obj.layers[1]         1  hidden_layer        4  logistic_sigmoid   
0        obj.layers[2]         2  hidden_layer        4  logistic_sigmoid   
0        obj.layers[3]         3  output_layer        2           softmax   

  x_l(weights)  add_bias b_l(biases)  
0         None     False        None  
0       (2, 4)     False        None  
0       (4, 4)     False        None  
0       (4, 2)     False        None  
Pytorch NN pbject created from original NN class. Change            original NN object to change structure.
-----------------------------------------------
Selected results: ConstProp_strategy on TRAINING dataset
constant withdrawal:  40.0
constant allocation:  [0.4 0.6]
W_T_mean: 2857.5794721877073
W_T_median: 1754.3232324177038
W_T_pctile_5: -231.97480281074152
W_T_CVAR_5_pct: -438.59555688158616
-----------------------------------------------
/home/marcchen/Documents/pytorch_decumulation_mc/researchcode/fun_construct_Feature_vector.py:82: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  wealth_n = torch.tensor(wealth_n, device=params["device"])
2.0% of gradient descent iterations done. Method = A
Current xi:  [9.102655]
objective value function right now is: -870.2719872721494
4.0% of gradient descent iterations done. Method = A
Current xi:  [9.013506]
objective value function right now is: -967.6525141581524
6.0% of gradient descent iterations done. Method = A
Current xi:  [8.934815]
objective value function right now is: -1018.3119244505383
8.0% of gradient descent iterations done. Method = A
Current xi:  [8.863969]
objective value function right now is: -1048.8169910735605
10.0% of gradient descent iterations done. Method = A
Current xi:  [8.801304]
objective value function right now is: -1066.4550475732112
12.0% of gradient descent iterations done. Method = A
Current xi:  [8.743125]
objective value function right now is: -1077.4864527393436
14.000000000000002% of gradient descent iterations done. Method = A
Current xi:  [8.69205]
objective value function right now is: -1084.2392577924147
16.0% of gradient descent iterations done. Method = A
Current xi:  [8.643324]
objective value function right now is: -1088.8134319797582
18.0% of gradient descent iterations done. Method = A
Current xi:  [8.594951]
objective value function right now is: -1092.42471456889
20.0% of gradient descent iterations done. Method = A
Current xi:  [8.550093]
objective value function right now is: -1094.7392299391977
22.0% of gradient descent iterations done. Method = A
Current xi:  [8.507799]
objective value function right now is: -1096.4531096517364
24.0% of gradient descent iterations done. Method = A
Current xi:  [8.467477]
objective value function right now is: -1097.8031028158628
26.0% of gradient descent iterations done. Method = A
Current xi:  [8.426031]
objective value function right now is: -1098.9522253496898
28.000000000000004% of gradient descent iterations done. Method = A
Current xi:  [8.383513]
objective value function right now is: -1100.004694610281
30.0% of gradient descent iterations done. Method = A
Current xi:  [8.339812]
objective value function right now is: -1100.9693858691203
32.0% of gradient descent iterations done. Method = A
Current xi:  [8.301421]
objective value function right now is: -1101.7227815130832
34.0% of gradient descent iterations done. Method = A
Current xi:  [8.2576885]
objective value function right now is: -1102.5245333235307
36.0% of gradient descent iterations done. Method = A
Current xi:  [8.216469]
objective value function right now is: -1103.261207471655
38.0% of gradient descent iterations done. Method = A
Current xi:  [8.174706]
objective value function right now is: -1104.1453714583674
40.0% of gradient descent iterations done. Method = A
Current xi:  [8.132282]
objective value function right now is: -1105.2279526993932
42.0% of gradient descent iterations done. Method = A
Current xi:  [8.092233]
objective value function right now is: -1106.1043134572533
44.0% of gradient descent iterations done. Method = A
Current xi:  [8.05389]
objective value function right now is: -1106.9032854940072
46.0% of gradient descent iterations done. Method = A
Current xi:  [8.0071335]
objective value function right now is: -1107.8552815690673
48.0% of gradient descent iterations done. Method = A
Current xi:  [7.956643]
objective value function right now is: -1108.7386347740357
50.0% of gradient descent iterations done. Method = A
Current xi:  [7.911452]
objective value function right now is: -1109.5367257499315
52.0% of gradient descent iterations done. Method = A
Current xi:  [7.8613687]
objective value function right now is: -1110.293137339665
54.0% of gradient descent iterations done. Method = A
Current xi:  [7.8081107]
objective value function right now is: -1111.5838639770352
56.00000000000001% of gradient descent iterations done. Method = A
Current xi:  [7.758111]
objective value function right now is: -1112.4317723695492
57.99999999999999% of gradient descent iterations done. Method = A
Current xi:  [7.701782]
objective value function right now is: -1113.073018497528
60.0% of gradient descent iterations done. Method = A
Current xi:  [7.6438236]
objective value function right now is: -1113.9801292868374
62.0% of gradient descent iterations done. Method = A
Current xi:  [7.5865245]
objective value function right now is: -1114.6151458770196
64.0% of gradient descent iterations done. Method = A
Current xi:  [7.5221605]
objective value function right now is: -1115.7729942509418
66.0% of gradient descent iterations done. Method = A
Current xi:  [7.464628]
objective value function right now is: -1116.198212246849
68.0% of gradient descent iterations done. Method = A
Current xi:  [7.4019594]
objective value function right now is: -1116.5249192378644
70.0% of gradient descent iterations done. Method = A
Current xi:  [7.333674]
objective value function right now is: -1117.8186374744798
72.0% of gradient descent iterations done. Method = A
Current xi:  [7.263411]
objective value function right now is: -1118.9779727665
74.0% of gradient descent iterations done. Method = A
Current xi:  [7.1981916]
objective value function right now is: -1119.9917175948758
76.0% of gradient descent iterations done. Method = A
Current xi:  [7.1229196]
objective value function right now is: -1122.4957109988616
78.0% of gradient descent iterations done. Method = A
Current xi:  [7.047526]
objective value function right now is: -1125.2228663964265
80.0% of gradient descent iterations done. Method = A
Current xi:  [6.971407]
objective value function right now is: -1128.203789842058
82.0% of gradient descent iterations done. Method = A
Current xi:  [6.8879175]
objective value function right now is: -1134.6242368017804
84.0% of gradient descent iterations done. Method = A
Current xi:  [6.796606]
objective value function right now is: -1142.3245195961752
86.0% of gradient descent iterations done. Method = A
Current xi:  [6.701386]
objective value function right now is: -1150.1539234714965
88.0% of gradient descent iterations done. Method = A
Current xi:  [6.6056204]
objective value function right now is: -1161.9149092244822
90.0% of gradient descent iterations done. Method = A
Current xi:  [6.5033283]
objective value function right now is: -1172.6895317779874
92.0% of gradient descent iterations done. Method = A
Current xi:  [6.407527]
objective value function right now is: -1182.5139373605084
94.0% of gradient descent iterations done. Method = A
Current xi:  [6.305952]
objective value function right now is: -1192.7622057668414
96.0% of gradient descent iterations done. Method = A
Current xi:  [6.201433]
objective value function right now is: -1198.462740349271
98.0% of gradient descent iterations done. Method = A
Current xi:  [6.1024733]
objective value function right now is: -1206.636612010662
100.0% of gradient descent iterations done. Method = A
Current xi:  [6.0025997]
objective value function right now is: -1210.6698750394546
-----------------------------------------------
Selected results: NN-strategy-on-TRAINING dataset (temp implementation
W_T_mean: 884.6478653688337
W_T_median: 726.2529450614647
W_T_pctile_5: -60.20180866799497
W_T_CVAR_5_pct: -205.8485262787206
Average q (qsum/M+1):  42.381564232610884
Optimal xi:  [6.0025997]
Expected(across Rb) median(across samples) p_equity:  0.30743520706892014
-----------------------------------------------
-----------------------------------------------
Just FINISHED: 
Asset basket ID: B10_and_VWD
Objective function: mean_cvar_single_level
Tracing param: 0.5
-----------------------------------------------
  obj.layers[layer_id]  layer_id   description  n_nodes        activation  \
0        obj.layers[0]         0   input_layer        2              None   
0        obj.layers[1]         1  hidden_layer        4  logistic_sigmoid   
0        obj.layers[2]         2  hidden_layer        4  logistic_sigmoid   
0        obj.layers[3]         3  output_layer        1  logistic_sigmoid   

  x_l(weights)  add_bias b_l(biases)  
0         None     False        None  
0       (2, 4)     False        None  
0       (4, 4)     False        None  
0       (4, 1)     False        None  
Pytorch NN pbject created from original NN class. Change            original NN object to change structure.
  obj.layers[layer_id]  layer_id   description  n_nodes        activation  \
0        obj.layers[0]         0   input_layer        2              None   
0        obj.layers[1]         1  hidden_layer        4  logistic_sigmoid   
0        obj.layers[2]         2  hidden_layer        4  logistic_sigmoid   
0        obj.layers[3]         3  output_layer        2           softmax   

  x_l(weights)  add_bias b_l(biases)  
0         None     False        None  
0       (2, 4)     False        None  
0       (4, 4)     False        None  
0       (4, 2)     False        None  
Pytorch NN pbject created from original NN class. Change            original NN object to change structure.
-----------------------------------------------
Selected results: ConstProp_strategy on TRAINING dataset
constant withdrawal:  40.0
constant allocation:  [0.4 0.6]
W_T_mean: 2857.5794721877073
W_T_median: 1754.3232324177038
W_T_pctile_5: -231.97480281074152
W_T_CVAR_5_pct: -438.59555688158616
-----------------------------------------------
/home/marcchen/Documents/pytorch_decumulation_mc/researchcode/fun_construct_Feature_vector.py:82: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  wealth_n = torch.tensor(wealth_n, device=params["device"])
2.0% of gradient descent iterations done. Method = A
Current xi:  [9.105453]
objective value function right now is: 361.40657888800934
4.0% of gradient descent iterations done. Method = A
Current xi:  [9.018868]
objective value function right now is: 25.404988715915685
6.0% of gradient descent iterations done. Method = A
Current xi:  [8.936551]
objective value function right now is: -232.12248346953683
8.0% of gradient descent iterations done. Method = A
Current xi:  [8.862785]
objective value function right now is: -423.6559994266196
10.0% of gradient descent iterations done. Method = A
Current xi:  [8.7952795]
objective value function right now is: -570.2223685871882
12.0% of gradient descent iterations done. Method = A
Current xi:  [8.734023]
objective value function right now is: -680.579190572009
14.000000000000002% of gradient descent iterations done. Method = A
Current xi:  [8.6769495]
objective value function right now is: -765.3695932524623
16.0% of gradient descent iterations done. Method = A
Current xi:  [8.625272]
objective value function right now is: -828.2157666589287
18.0% of gradient descent iterations done. Method = A
Current xi:  [8.579623]
objective value function right now is: -875.3587086221304
20.0% of gradient descent iterations done. Method = A
Current xi:  [8.539084]
objective value function right now is: -910.8621108689149
22.0% of gradient descent iterations done. Method = A
Current xi:  [8.501989]
objective value function right now is: -939.1801480873419
24.0% of gradient descent iterations done. Method = A
Current xi:  [8.467843]
objective value function right now is: -961.6338912203967
26.0% of gradient descent iterations done. Method = A
Current xi:  [8.436135]
objective value function right now is: -979.623031101064
28.000000000000004% of gradient descent iterations done. Method = A
Current xi:  [8.407888]
objective value function right now is: -993.7531375508268
30.0% of gradient descent iterations done. Method = A
Current xi:  [8.381237]
objective value function right now is: -1005.7580639728145
32.0% of gradient descent iterations done. Method = A
Current xi:  [8.3597555]
objective value function right now is: -1014.4501873443486
34.0% of gradient descent iterations done. Method = A
Current xi:  [8.33879]
objective value function right now is: -1022.5797604476993
36.0% of gradient descent iterations done. Method = A
Current xi:  [8.319393]
objective value function right now is: -1028.9943281476876
38.0% of gradient descent iterations done. Method = A
Current xi:  [8.304008]
objective value function right now is: -1034.267032179423
40.0% of gradient descent iterations done. Method = A
Current xi:  [8.290956]
objective value function right now is: -1038.549925447993
42.0% of gradient descent iterations done. Method = A
Current xi:  [8.280269]
objective value function right now is: -1041.9629248390916
44.0% of gradient descent iterations done. Method = A
Current xi:  [8.26905]
objective value function right now is: -1045.0551798027
46.0% of gradient descent iterations done. Method = A
Current xi:  [8.261223]
objective value function right now is: -1047.5788740017208
48.0% of gradient descent iterations done. Method = A
Current xi:  [8.257095]
objective value function right now is: -1049.786606776075
50.0% of gradient descent iterations done. Method = A
Current xi:  [8.253851]
objective value function right now is: -1051.5726366995475
52.0% of gradient descent iterations done. Method = A
Current xi:  [8.252653]
objective value function right now is: -1053.2369570339695
54.0% of gradient descent iterations done. Method = A
Current xi:  [8.251472]
objective value function right now is: -1054.5791445596074
56.00000000000001% of gradient descent iterations done. Method = A
Current xi:  [8.254753]
objective value function right now is: -1055.9276299058154
57.99999999999999% of gradient descent iterations done. Method = A
Current xi:  [8.260567]
objective value function right now is: -1056.7328658303625
60.0% of gradient descent iterations done. Method = A
Current xi:  [8.266868]
objective value function right now is: -1058.0178516294309
62.0% of gradient descent iterations done. Method = A
Current xi:  [8.274737]
objective value function right now is: -1058.9708209570074
64.0% of gradient descent iterations done. Method = A
Current xi:  [8.28391]
objective value function right now is: -1059.5552892738338
66.0% of gradient descent iterations done. Method = A
Current xi:  [8.300129]
objective value function right now is: -1060.397461124674
68.0% of gradient descent iterations done. Method = A
Current xi:  [8.316042]
objective value function right now is: -1061.2161546211764
70.0% of gradient descent iterations done. Method = A
Current xi:  [8.335316]
objective value function right now is: -1061.704530953303
72.0% of gradient descent iterations done. Method = A
Current xi:  [8.355078]
objective value function right now is: -1062.1437220805306
74.0% of gradient descent iterations done. Method = A
Current xi:  [8.3720665]
objective value function right now is: -1062.9295677387156
76.0% of gradient descent iterations done. Method = A
Current xi:  [8.394603]
objective value function right now is: -1063.6498839407652
78.0% of gradient descent iterations done. Method = A
Current xi:  [8.414644]
objective value function right now is: -1064.234768550611
80.0% of gradient descent iterations done. Method = A
Current xi:  [8.438705]
objective value function right now is: -1064.841152997303
82.0% of gradient descent iterations done. Method = A
Current xi:  [8.470902]
objective value function right now is: -1065.3462247499203
84.0% of gradient descent iterations done. Method = A
Current xi:  [8.50642]
objective value function right now is: -1065.764128707288
86.0% of gradient descent iterations done. Method = A
Current xi:  [8.548198]
objective value function right now is: -1066.227253028766
88.0% of gradient descent iterations done. Method = A
Current xi:  [8.578327]
objective value function right now is: -1066.8610760277063
90.0% of gradient descent iterations done. Method = A
Current xi:  [8.614945]
objective value function right now is: -1067.6011494083903
92.0% of gradient descent iterations done. Method = A
Current xi:  [8.650018]
objective value function right now is: -1067.8287887632632
94.0% of gradient descent iterations done. Method = A
Current xi:  [8.687172]
objective value function right now is: -1068.8365897024235
96.0% of gradient descent iterations done. Method = A
Current xi:  [8.726981]
objective value function right now is: -1069.3888288168694
98.0% of gradient descent iterations done. Method = A
Current xi:  [8.768035]
objective value function right now is: -1070.0738547942722
100.0% of gradient descent iterations done. Method = A
Current xi:  [8.81819]
objective value function right now is: -1070.4512095437296
-----------------------------------------------
Selected results: NN-strategy-on-TRAINING dataset (temp implementation
W_T_mean: 1259.3167212668664
W_T_median: 1070.919824989005
W_T_pctile_5: 110.957806483577
W_T_CVAR_5_pct: -51.9012914272596
Average q (qsum/M+1):  36.25688319052419
Optimal xi:  [8.81819]
Expected(across Rb) median(across samples) p_equity:  0.2947149522602558
-----------------------------------------------
-----------------------------------------------
Just FINISHED: 
Asset basket ID: B10_and_VWD
Objective function: mean_cvar_single_level
Tracing param: 1.0
-----------------------------------------------
  obj.layers[layer_id]  layer_id   description  n_nodes        activation  \
0        obj.layers[0]         0   input_layer        2              None   
0        obj.layers[1]         1  hidden_layer        4  logistic_sigmoid   
0        obj.layers[2]         2  hidden_layer        4  logistic_sigmoid   
0        obj.layers[3]         3  output_layer        1  logistic_sigmoid   

  x_l(weights)  add_bias b_l(biases)  
0         None     False        None  
0       (2, 4)     False        None  
0       (4, 4)     False        None  
0       (4, 1)     False        None  
Pytorch NN pbject created from original NN class. Change            original NN object to change structure.
  obj.layers[layer_id]  layer_id   description  n_nodes        activation  \
0        obj.layers[0]         0   input_layer        2              None   
0        obj.layers[1]         1  hidden_layer        4  logistic_sigmoid   
0        obj.layers[2]         2  hidden_layer        4  logistic_sigmoid   
0        obj.layers[3]         3  output_layer        2           softmax   

  x_l(weights)  add_bias b_l(biases)  
0         None     False        None  
0       (2, 4)     False        None  
0       (4, 4)     False        None  
0       (4, 2)     False        None  
Pytorch NN pbject created from original NN class. Change            original NN object to change structure.
-----------------------------------------------
Selected results: ConstProp_strategy on TRAINING dataset
constant withdrawal:  40.0
constant allocation:  [0.4 0.6]
W_T_mean: 2857.5794721877073
W_T_median: 1754.3232324177038
W_T_pctile_5: -231.97480281074152
W_T_CVAR_5_pct: -438.59555688158616
-----------------------------------------------
/home/marcchen/Documents/pytorch_decumulation_mc/researchcode/fun_construct_Feature_vector.py:82: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  wealth_n = torch.tensor(wealth_n, device=params["device"])
2.0% of gradient descent iterations done. Method = A
Current xi:  [9.107975]
objective value function right now is: 1720.8112341627768
4.0% of gradient descent iterations done. Method = A
Current xi:  [9.041279]
objective value function right now is: 595.0708557105426
6.0% of gradient descent iterations done. Method = A
Current xi:  [8.997242]
objective value function right now is: -33.7666197883526
8.0% of gradient descent iterations done. Method = A
Current xi:  [8.967182]
objective value function right now is: -378.41745115474924
10.0% of gradient descent iterations done. Method = A
Current xi:  [8.947966]
objective value function right now is: -565.1661965830649
12.0% of gradient descent iterations done. Method = A
Current xi:  [8.939915]
objective value function right now is: -661.1070112919731
14.000000000000002% of gradient descent iterations done. Method = A
Current xi:  [8.936172]
objective value function right now is: -718.8564512586343
16.0% of gradient descent iterations done. Method = A
Current xi:  [8.938111]
objective value function right now is: -759.3311230833724
18.0% of gradient descent iterations done. Method = A
Current xi:  [8.941622]
objective value function right now is: -789.9363918025228
20.0% of gradient descent iterations done. Method = A
Current xi:  [8.9484005]
objective value function right now is: -814.4472414509443
22.0% of gradient descent iterations done. Method = A
Current xi:  [8.97091]
objective value function right now is: -834.0963811581717
24.0% of gradient descent iterations done. Method = A
Current xi:  [8.998524]
objective value function right now is: -849.9468402031929
26.0% of gradient descent iterations done. Method = A
Current xi:  [9.03052]
objective value function right now is: -863.0790580111905
28.000000000000004% of gradient descent iterations done. Method = A
Current xi:  [9.06315]
objective value function right now is: -875.1722509978327
30.0% of gradient descent iterations done. Method = A
Current xi:  [9.098448]
objective value function right now is: -885.6515609045199
32.0% of gradient descent iterations done. Method = A
Current xi:  [9.141894]
objective value function right now is: -894.609678652114
34.0% of gradient descent iterations done. Method = A
Current xi:  [9.186041]
objective value function right now is: -902.9376463011948
36.0% of gradient descent iterations done. Method = A
Current xi:  [9.234895]
objective value function right now is: -910.7452068511135
38.0% of gradient descent iterations done. Method = A
Current xi:  [9.282829]
objective value function right now is: -917.6470394643799
40.0% of gradient descent iterations done. Method = A
Current xi:  [9.343575]
objective value function right now is: -924.5189008253908
42.0% of gradient descent iterations done. Method = A
Current xi:  [9.415156]
objective value function right now is: -930.5803352779658
44.0% of gradient descent iterations done. Method = A
Current xi:  [9.474024]
objective value function right now is: -936.4155957376015
46.0% of gradient descent iterations done. Method = A
Current xi:  [9.532445]
objective value function right now is: -941.7941099288884
48.0% of gradient descent iterations done. Method = A
Current xi:  [9.597326]
objective value function right now is: -947.1096836261568
50.0% of gradient descent iterations done. Method = A
Current xi:  [9.658797]
objective value function right now is: -952.3828254713728
52.0% of gradient descent iterations done. Method = A
Current xi:  [9.741174]
objective value function right now is: -957.2433552414199
54.0% of gradient descent iterations done. Method = A
Current xi:  [9.803106]
objective value function right now is: -962.2162284094418
56.00000000000001% of gradient descent iterations done. Method = A
Current xi:  [9.885254]
objective value function right now is: -967.3141261205799
57.99999999999999% of gradient descent iterations done. Method = A
Current xi:  [9.948588]
objective value function right now is: -971.8065247157747
60.0% of gradient descent iterations done. Method = A
Current xi:  [10.028143]
objective value function right now is: -976.3003491973852
62.0% of gradient descent iterations done. Method = A
Current xi:  [10.09587]
objective value function right now is: -980.143401386369
64.0% of gradient descent iterations done. Method = A
Current xi:  [10.16821]
objective value function right now is: -985.0168712084961
66.0% of gradient descent iterations done. Method = A
Current xi:  [10.250564]
objective value function right now is: -989.1351691731415
68.0% of gradient descent iterations done. Method = A
Current xi:  [10.320982]
objective value function right now is: -993.6088303377554
70.0% of gradient descent iterations done. Method = A
Current xi:  [10.389866]
objective value function right now is: -997.081166476149
72.0% of gradient descent iterations done. Method = A
Current xi:  [10.461734]
objective value function right now is: -1001.5531380170863
74.0% of gradient descent iterations done. Method = A
Current xi:  [10.533056]
objective value function right now is: -1005.1654503639387
76.0% of gradient descent iterations done. Method = A
Current xi:  [10.595656]
objective value function right now is: -1009.6503932083377
78.0% of gradient descent iterations done. Method = A
Current xi:  [10.657922]
objective value function right now is: -1013.3541562177791
80.0% of gradient descent iterations done. Method = A
Current xi:  [10.737924]
objective value function right now is: -1017.0414271651549
82.0% of gradient descent iterations done. Method = A
Current xi:  [10.803039]
objective value function right now is: -1020.6090926330248
84.0% of gradient descent iterations done. Method = A
Current xi:  [10.876033]
objective value function right now is: -1024.0048650228032
86.0% of gradient descent iterations done. Method = A
Current xi:  [10.950192]
objective value function right now is: -1027.7985011830272
88.0% of gradient descent iterations done. Method = A
Current xi:  [11.016419]
objective value function right now is: -1031.2548677506647
90.0% of gradient descent iterations done. Method = A
Current xi:  [11.0854845]
objective value function right now is: -1034.106234076832
92.0% of gradient descent iterations done. Method = A
Current xi:  [11.13682]
objective value function right now is: -1037.6407934563729
94.0% of gradient descent iterations done. Method = A
Current xi:  [11.198902]
objective value function right now is: -1040.9594662861589
96.0% of gradient descent iterations done. Method = A
Current xi:  [11.262198]
objective value function right now is: -1043.4912033339626
98.0% of gradient descent iterations done. Method = A
Current xi:  [11.313327]
objective value function right now is: -1046.6992259936587
100.0% of gradient descent iterations done. Method = A
Current xi:  [11.376207]
objective value function right now is: -1050.23686585778
-----------------------------------------------
Selected results: NN-strategy-on-TRAINING dataset (temp implementation
W_T_mean: 1325.7242139532862
W_T_median: 1136.538687058583
W_T_pctile_5: 159.3455293787181
W_T_CVAR_5_pct: -6.362482475850378
Average q (qsum/M+1):  35.06690240675403
Optimal xi:  [11.376207]
Expected(across Rb) median(across samples) p_equity:  0.2898377607266108
-----------------------------------------------
-----------------------------------------------
Just FINISHED: 
Asset basket ID: B10_and_VWD
Objective function: mean_cvar_single_level
Tracing param: 5.0
-----------------------------------------------
